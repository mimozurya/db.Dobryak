INSERT authors VALUES('111-00-0004', 'Алексей', 'Хохлов', '223 226-2295', '589 5-я Строителей', 'С-Петербург', 'РФ', '94113', 0)
INSERT authors VALUES('409-56-7008', 'Bennet', 'Abraham', '415 658-9932', '6223 Bateman St.', 'Berkeley', 'CA', '94705', 1)
INSERT authors VALUES('213-46-8915', 'Green', 'Marjorie', '415 986-7020', '309 63rd St. #411', 'Oakland', 'CA', '94618', 1)
INSERT authors VALUES('238-95-7766', 'Carson', 'Cheryl', '415 548-7723', '589 Darwin Ln.', 'Berkeley', 'CA', '94705', 1)
INSERT authors VALUES('111-00-0001', 'Игорь', 'Фигурнов', '223 226-8884', '589 Б.Полянка', 'Москва', 'РФ', '94111', 1)
INSERT authors VALUES('998-72-3567', 'Ringer', 'Albert', '801 826-0752', '67 Seventh Av.', 'Salt Lake City', 'UT', '84152', 1)
INSERT authors VALUES('899-46-2035', 'Ringer', 'Anne', '801 826-0752', '67 Seventh Av.', 'Salt Lake City', 'UT', '84152', 1)
INSERT authors VALUES('111-00-0002', 'Сергей', 'Каратыгин', '223 226-2294','589 2-я Ямская', 'Москва', 'РФ', '94112', 1)
INSERT authors VALUES('722-51-5454', 'DeFrance', 'Michel', '219 547-9982', '3 Balding Pl.', 'Gary', 'IN', '46403', 1)
INSERT authors VALUES('807-91-6654', 'Panteley', 'Sylvia', '301 946-8853', '1956 Arlington Pl.', 'Rockville', 'MD', '20853', 1)
INSERT authors VALUES('893-72-1158', 'McBadden', 'Heather', '707 448-4982', '301 Putnam', 'Vacaville', 'CA', '95688', 0)
INSERT authors VALUES('724-08-9931', 'Stringer', 'Dirk', '415 843-2991', '5420 Telegraph Av.', 'Oakland', 'CA', '94609', 0)
INSERT authors VALUES('274-80-9391', 'Straight', 'Dean', '415 834-2919', '5420 College Av.', 'Oakland', 'CA', '94609', 1)
INSERT authors VALUES('756-30-7391', 'Karsen', 'Livia', '415 534-9219', '5720 McAuley St.', 'Oakland', 'CA', '94609', 1)
INSERT authors VALUES('724-80-9391', 'MacFeather', 'Stearns', '415 354-7128', '44 Upland Hts.', 'Oakland', 'CA', '94612', 1)
INSERT authors VALUES('427-17-2319', 'Dull', 'Ann', '415 836-7128', '3410 Blonde St.', 'Palo Alto', 'CA', '94301', 1)
INSERT authors VALUES('672-71-3249', 'Yokomoto', 'Akiko', '415 935-4228', '3 Silver Ct.', 'Walnut Creek', 'CA', '94595', 1)
INSERT authors VALUES('267-41-2394', 'O''Leary', 'Michael', '408 286-2428', '22 Cleveland Av. #14', 'San Jose', 'CA', '95128', 1)
INSERT authors VALUES('472-27-2349', 'Gringlesby', 'Burt', '707 938-6445', 'PO Box 792', 'Covelo', 'CA', '95428', 3)
INSERT authors VALUES('527-72-3246', 'Greene', 'Morningstar', '615 297-2723', '22 Graybar House Rd.', 'Nashville', 'TN', '37215', 0)
INSERT authors VALUES('172-32-1176', 'White', 'Johnson', '408 496-7223', '10932 Bigge Rd.', 'Menlo Park', 'CA', '94025', 1)
INSERT authors VALUES('712-45-1867', 'del Castillo', 'Innes', '615 996-8275', 	'2286 Cram Pl. #86', 'Ann Arbor', 'MI', '48105', 1)
INSERT authors VALUES('846-92-7186', 'Hunter', 'Sheryl', '415 836-7128', '3410 Blonde St.', 'Palo Alto', 'CA', '94301', 1)
INSERT authors VALUES('486-29-1786', 'Locksley', 'Charlene', '415 585-4620', '18 Broadway Av.', 'San Francisco', 'CA', '94130', 1)
INSERT authors VALUES('648-92-1872', 'Blotchet-Halls', 'Reginald', '503 745-6402','55 Hillsdale Bl.', 'Corvallis', 'OR', '97330', 1)
INSERT authors VALUES('341-22-1782', 'Smith', 'Meander', '913 843-0462', '10 Mississippi Dr.', 'Lawrence', 'KS', '66044', 0)
SELECT * FROM authors

INSERT titles VALUES('PC1111', 'Популярно о компьютере', 'popular_comp', '1389', $20.00, $8000.00, 10, 4095, 'Muckraking reporting on the world''s largest computer hardware and software manufacturers.', '06/12/94')
INSERT titles VALUES('PC8888', 'Secrets of Silicon Valley', 'popular_comp', '1389', $20.00, $8000.00, 10, 4095, 'Muckraking reporting on the world''s largest computer hardware and software manufacturers.', '06/12/94')
INSERT titles VALUES('BU1032', 'The Busy Executive''s Database Guide', 'business', '1389', $19.99, $5000.00, 10, 4095, 'An overview of available database systems with emphasis on common business applications. Illustrated.', '06/12/91')
INSERT titles VALUES('PS7777', 'Emotional Security: A New Algorithm', 'psychology', '0736', $7.99, $4000.00, 10, 3336, 'Protecting yourself and your loved ones from undue emotional stress in the modern world. Use of computer and nutritional aids emphasized.', '06/12/91')
INSERT titles VALUES('PS3333', 'Prolonged Data Deprivation: Four Case Studies', 'psychology', '0736', $19.99, $2000.00, 10, 4072, 'What happens when the data runs dry? Searching evaluations of information-shortage effects.', '06/12/91')
INSERT titles VALUES('BU1111', 'Cooking with Computers: Surreptitious Balance Sheets', 'business', '1389', $11.95, $5000.00, 10, 3876, 'Helpful hints on how to use your electronic resources to the best advantage.', '06/09/91')
INSERT titles VALUES('MC2222', 'Silicon Valley Gastronomic Treats', 'mod_cook', '0877', $19.99, $0.00, 12, 2032, 'Favorite recipes for quick, easy, and elegant meals.', '06/09/91')
INSERT titles VALUES('TC7777', 'Sushi, Anyone?', 'trad_cook', '0877', $14.99, $8000.00, 10, 4095, 'Detailed instructions on how to make authentic Japanese sushi in your spare time.', '06/12/91')
INSERT titles VALUES('TC4203', 'Fifty Years in Buckingham Palace Kitchens', 'trad_cook', '0877', $11.95, $4000.00, 14, 15096, 'More anecdotes from the Queens favorite cook describing life among English royalty. Recipes, techniques, tender vignettes.', '06/12/91')
INSERT titles VALUES('PC1035', 'But Is It User Friendly?', 'popular_comp', '1389', $22.95, $7000.00, 16, 8780, 'A survey of software for the naive user, focusing on the friendliness of each.', '06/30/91')
INSERT titles VALUES('BU2075', 'You Can Combat Computer Stress!', 'business', '0736', $2.99, $10125.00, 24, 18722, 'The latest medical and psychological techniques for living with the electronic office. Easy-to-understand explanations.', '06/30/91')
INSERT titles VALUES('PS2095', 'Is Anger the Enemy?', 'psychology', '0736', $10.95, $2275.00, 12, 2045, 'Carefully researched study of the effects of strong emotions on the body. Metabolic charts included.', '06/15/91')
INSERT titles VALUES('PS2106', 'Life Without Fear', 'psychology', '0736', $7.00, $6000.00, 10, 111, 'New exercise, meditation, and nutritional techniques that can reduce the shock of daily interactions. Popular audience. Sample menus included, exercise video available separately.', '10/05/91')
INSERT titles VALUES('MC3021', 'The Gourmet Microwave', 'mod_cook', '0877', $2.99, $15000.00, 24, 22246, 'Traditional French gourmet recipes adapted for modern microwave cooking.', '06/18/91')
INSERT titles VALUES('TC3219', 'Onions, Leeks, and Garlic: Cooking Secrets of the Mediterranean', 'trad_cook', '0877', $20.95, $7000.00, 10, 375, 'Profusely illustrated in color, this makes a wonderful gift book for a cuisine-oriented friend.', '10/21/91')
INSERT titles VALUES('BU7832', 'Straight Talk About Computers', 'business', '1389', $19.99, $5000.00, 10, 4095, 'Annotated analysis of what computers can do for you: a no-hype guide for the critical user.', '06/22/91')
INSERT titles VALUES('PS1372', 'Computer Phobic AND Non-Phobic Individuals: Behavior Variations', 'psychology', '0877', $21.59, $7000.00, 10, 375, 'A must for the specialist, this book examines the difference between those who hate and fear computers and those who don''t.', '10/21/91')
INSERT titles VALUES('PC9999', 'Net Etiquette', 'popular_comp', '1389', $19.99, $5000.00, 10, 4095, 'A must-read for computer conferencing.', '12.10/23')
SELECT * FROM titles

INSERT titleauthor VALUES('409-56-7008', 'BU1032', 1, 60)
INSERT titleauthor VALUES('486-29-1786', 'PS7777', 1, 100)
INSERT titleauthor VALUES('486-29-1786', 'PC9999', 1, 100)
INSERT titleauthor VALUES('712-45-1867', 'MC2222', 1, 100)
INSERT titleauthor VALUES('172-32-1176', 'PS3333', 1, 100)
INSERT titleauthor VALUES('213-46-8915', 'BU1032', 2, 40)
INSERT titleauthor VALUES('238-95-7766', 'PC1035', 1, 100)
INSERT titleauthor VALUES('213-46-8915', 'BU2075', 1, 100)
INSERT titleauthor VALUES('998-72-3567', 'PS2106', 1, 100)
INSERT titleauthor VALUES('722-51-5454', 'MC3021', 1, 75)
INSERT titleauthor VALUES('899-46-2035', 'MC3021', 2, 25)
INSERT titleauthor VALUES('274-80-9391', 'BU7832', 1, 100)
INSERT titleauthor VALUES('427-17-2319', 'PC8888', 1, 50)
INSERT titleauthor VALUES('756-30-7391', 'PS1372', 1, 75)
INSERT titleauthor VALUES('724-80-9391', 'PS1372', 2, 25)
INSERT titleauthor VALUES('724-80-9391', 'BU1111', 1, 60)
INSERT titleauthor VALUES('267-41-2394', 'BU1111', 2, 40)
INSERT titleauthor VALUES('672-71-3249', 'TC7777', 1, 40)
INSERT titleauthor VALUES('267-41-2394', 'TC7777', 2, 30)
INSERT titleauthor VALUES('472-27-2349', 'TC7777', 3, 30)
INSERT titleauthor VALUES('648-92-1872', 'TC4203', 1, 100)
SELECT * FROM titleauthor

INSERT sales VALUES('7066', 'QA7442.3', '09/13/94', 75, 'ON invoice','PS2091')
INSERT sales VALUES('7067', 'D4482', '09/14/94', 10, 'Net 60','PS2091')
INSERT sales VALUES('7131', 'N914008', '09/14/94', 20, 'Net 30','PS2091')
INSERT sales VALUES('7131', 'N914014', '09/14/94', 25, 'Net 30','MC3021')
INSERT sales VALUES('8042', '423LL922', '09/14/94', 15, 'ON invoice','MC3021')
INSERT sales VALUES('8042', '423LL930', '09/14/94', 10, 'ON invoice','BU1032')
INSERT sales VALUES('6380', '722a', '09/13/94', 3, 'Net 60','PS2091')
INSERT sales VALUES('6380', '6871', '09/14/94', 5, 'Net 60','BU1032')
INSERT sales VALUES('8042','P723', '03/11/93', 25, 'Net 30', 'BU1111')
INSERT sales VALUES('7896','X999', '02/21/93', 35, 'ON invoice', 'BU2075')
INSERT sales VALUES('7896','QQ2299', '10/28/93', 15, 'Net 60', 'BU7832')
INSERT sales VALUES('7896','TQ456', '12/12/93', 10, 'Net 60', 'MC2222')
INSERT sales VALUES('8042','QA879.1', '5/22/93', 30, 'Net 30', 'PC1035')
INSERT sales VALUES('7066','A2976', '5/24/93', 50, 'Net 30', 'PC8888')
INSERT sales VALUES('7131','P3087a', '5/29/93', 20, 'Net 60', 'PS1372')
INSERT sales VALUES('7131','P3087a', '5/29/93', 25, 'Net 60', 'PS2106')
INSERT sales VALUES('7131','P3087a', '5/29/93', 15, 'Net 60', 'PS3333')
INSERT sales VALUES('7131','P3087a', '5/29/93', 25, 'Net 60', 'PS7777')
INSERT sales VALUES('7067','P2121', '6/15/92', 40, 'Net 30', 'TC3218')
INSERT sales VALUES('7067','P2121', '6/15/92', 20, 'Net 30', 'TC4203')
INSERT sales VALUES('7067','P2121', '6/15/92', 20, 'Net 30', 'TC7777')
SELECT * FROM sales

CREATE TABLE new_table (
  new_id VARCHAR(11) CHECK (new_id like '[0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9][0-9][0-9]'),
  new_lname varchar(40) NOT NULL,
  new_fname varchar(20) NOT NULL,
  phone char(12) NOT NULL DEFAULT ('UNKNOWN'),
  address varchar(40) NULL,
  city varchar(20) NULL,
  state char(2) NULL,
  zip char(5) NULL CHECK (zip like '[0-9][0-9][0-9][0-9][0-9]'),
  contract bit NOT NULL
);

DROP TABLE new_table

INSERT INTO new_table
SELECT *
FROM authors
WHERE state = 'UT';

SELECT * FROM new_table

INSERT INTO authors
SELECT *
FROM new_table;

SELECT *
FROM authors
JOIN titles ON authors.au_id = titles.au_id
JOIN titleauthor ON titles.title_id = titleauthor.title_id
JOIN sales ON titleauthor.title_id = sales.title_id;